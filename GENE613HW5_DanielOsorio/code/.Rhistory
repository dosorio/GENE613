nValues <- c(nValues,mean(variable[validRecord & year %in% seq_len(year[i])]))
}
ERPA <- nValues * vRn
ACC <- sqrt(vRn)
cbind(ERPA, ACC)
cbind(YEAR = year,ERPA, ACC)
cbind(ID = id, YEAR = year,ERPA, ACC)
n
nValues <- mean(variable[validRecord & year %in% seq_len(max(n))])
nValues
nValues <- mean(variable[validRecord & year %in% seq_len(max(year[n]))])
nValues <- mean(variable[validRecord & year %in% seq_len(max(year))])
ERPA <- nValues * vRn
ACC <- sqrt(vRn)
cbind(ID = id, YEAR = year,ERPA, ACC)
id <- unique(ID)[1]
value <- !is.na(variable)
validRecord <- ID %in% id & value
R <- 0.59
n <- order(YEAR[validRecord])
vRn <- Rn(n = n,R = R)
year <- YEAR[validRecord]
nValues <- mean(variable[validRecord & year %in% seq_len(max(year))])
ERPA <- nValues * vRn
ACC <- sqrt(vRn)
cbind(ID = id, YEAR = year,ERPA, ACC)
cbind(ID = id, n = n,ERPA, ACC)
variable <- adjust(values = BW, groups = YEAR)
id <- unique(ID)[1]
value <- !is.na(variable)
validRecord <- ID %in% id & value
R <- 0.59
n <- order(YEAR[validRecord])
vRn <- Rn(n = n,R = R)
year <- YEAR[validRecord]
nValues <- mean(variable[validRecord & year %in% seq_len(max(year))])
ERPA <- nValues * vRn
ACC <- sqrt(vRn)
cbind(ID = id, n = n,ERPA, ACC)
variable <- adjust(values = FAMACHA, groups = YEAR)
id <- unique(ID)[1]
value <- !is.na(variable)
validRecord <- ID %in% id & value
R <- 0.59
n <- order(YEAR[validRecord])
vRn <- Rn(n = n,R = R)
year <- YEAR[validRecord]
nValues <- mean(variable[validRecord & year %in% seq_len(max(year))])
ERPA <- nValues * vRn
ACC <- sqrt(vRn)
cbind(ID = id, n = n,ERPA, ACC)
variable <- adjust(values = FAMACHA, groups = YEAR)
id <- unique(ID)[1]
value <- !is.na(variable)
validRecord <- ID %in% id & value
R <- 0.59
n <- order(YEAR[validRecord])
vRn <- Rn(n = n,R = R)
vRn
n
n <- max(order(YEAR[validRecord]))
vRn <- Rn(n = n,R = R)
year <- YEAR[validRecord]
year
n
seq_len(max(year))
year
year %in% year
year %in% max(year)
year %in% max(year)
year
year %in% seq_len(max(year))
validRecord & year %in% seq_len(max(year))
variable[validRecord & year %in% seq_len(max(year))]
mean(variable[validRecord & year %in% seq_len(max(year))])
nValues <- mean(variable[validRecord & year %in% seq_len(max(year))])
ERPA <- nValues * vRn
ERPA
ACC <- sqrt(vRn)
cbind(ID = id, n = n,ERPA, ACC)
id <- unique(ID)[5]
value <- !is.na(variable)
validRecord <- ID %in% id & value
R <- 0.59
n <- max(order(YEAR[validRecord]))
vRn <- Rn(n = n,R = R)
year <- YEAR[validRecord]
nValues <- mean(variable[validRecord & year %in% seq_len(max(year))])
ERPA <- nValues * vRn
nValues <- mean(variable[validRecord & seq_len(max(year)) %in% year])
ERPA <- nValues * vRn
ACC <- sqrt(vRn)
cbind(ID = id, n = n,ERPA, ACC)
vRn
read.delim("../data/")
read.delim("../data/test.csv")
read.csv("../data/test.csv")
a <- read.csv("../data/test.csv")
attach(a)
id <- unique(ID)[5]
variable <- a$FAMACHA
value <- !is.na(variable)
validRecord <- ID %in% id & value
R <- 0.59
n <- max(order(YEAR[validRecord]))
vRn <- Rn(n = n,R = R)
n <- max(order(YEAR[validRecord]))
validRecord
id <- unique(ID)[1]
value <- !is.na(variable)
validRecord <- ID %in% id & value
R <- 0.59
n <- max(order(YEAR[validRecord]))
vRn <- Rn(n = n,R = R)
year <- YEAR[validRecord]
nValues <- mean(variable[validRecord & seq_len(max(year)) %in% year])
ERPA <- nValues * vRn
ACC <- sqrt(vRn)
cbind(ID = id, n = n,ERPA, ACC)
variable <- adjust(values = FAMACHA, groups = YEAR)
a <- read.csv("../data/test.csv")
attach(a)
variable <- a$FAMACHA
id <- unique(ID)[1]
value <- !is.na(variable)
validRecord <- ID %in% id & value
R <- 0.5
n <- max(order(YEAR[validRecord]))
vRn <- Rn(n = n,R = R)
year <- YEAR[validRecord]
nValues <- mean(variable[validRecord & seq_len(max(year)) %in% year])
ERPA <- nValues * vRn
ACC <- sqrt(vRn)
cbind(ID = id, n = n,ERPA, ACC)
id <- unique(ID)[4]
value <- !is.na(variable)
validRecord <- ID %in% id & value
R <- 0.5
n <- max(order(YEAR[validRecord]))
vRn <- Rn(n = n,R = R)
year <- YEAR[validRecord]
nValues <- mean(variable[validRecord & seq_len(max(year)) %in% year])
ERPA <- nValues * vRn
ACC <- sqrt(vRn)
cbind(ID = id, n = n,ERPA, ACC)
year
seq_len(max(year))
seq_len(max(year)) %in% year
validRecord & seq_len(max(year)) %in% year
validRecord
year <- YEAR[validRecord & ID %in% id]
nValues <- mean(variable[validRecord & seq_len(max(year)) %in% year])
ID %in% id
value
nValues <- mean(variable[validRecord[ID %in% id] & seq_len(max(year)) %in% year])
ERPA <- nValues * vRn
ACC <- sqrt(vRn)
cbind(ID = id, n = n,ERPA, ACC)
validRecord[ID %in% id]
seq_len(max(year)) %in% year
a <- read.csv("../data/test.csv")
attach(a)
variable <- a$FAMACHA
id <- unique(ID)[4]
value <- !is.na(variable)
validRecord <- ID %in% id & value
R <- 0.5
n <- max(order(YEAR[validRecord]))
vRn <- Rn(n = n,R = R)
year <- YEAR[validRecord]
nValues <- mean(variable[validRecord[ID %in% id] & seq_len(max(year)) %in% year])
ERPA <- nValues * vRn
ACC <- sqrt(vRn)
cbind(ID = id, n = n,ERPA, ACC)
ID %in% id
validRecord[ID %in% id]
variable
variable[validRecord]
nValues <- mean(variable[validRecord][seq_len(max(year)) %in% year])
nValues
ERPA <- nValues * vRn
ACC <- sqrt(vRn)
cbind(ID = id, n = n,ERPA, ACC)
a <- read.csv("../data/test.csv")
attach(a)
variable <- a$FAMACHA
id <- unique(ID)[1]
value <- !is.na(variable)
validRecord <- ID %in% id & value
R <- 0.5
n <- max(order(YEAR[validRecord]))
vRn <- Rn(n = n,R = R)
year <- YEAR[validRecord]
nValues <- mean(variable[validRecord][seq_len(max(year)) %in% year])
ERPA <- nValues * vRn
ACC <- sqrt(vRn)
cbind(ID = id, n = n,ERPA, ACC)
id <- unique(ID)[2]
value <- !is.na(variable)
validRecord <- ID %in% id & value
R <- 0.5
n <- max(order(YEAR[validRecord]))
vRn <- Rn(n = n,R = R)
year <- YEAR[validRecord]
nValues <- mean(variable[validRecord][seq_len(max(year)) %in% year])
ERPA <- nValues * vRn
ACC <- sqrt(vRn)
cbind(ID = id, n = n,ERPA, ACC)
id <- unique(ID)[3]
value <- !is.na(variable)
validRecord <- ID %in% id & value
R <- 0.5
n <- max(order(YEAR[validRecord]))
vRn <- Rn(n = n,R = R)
year <- YEAR[validRecord]
nValues <- mean(variable[validRecord][seq_len(max(year)) %in% year])
ERPA <- nValues * vRn
ACC <- sqrt(vRn)
cbind(ID = id, n = n,ERPA, ACC)
a <- read.csv("../data/test.csv")
attach(a)
variable <- a$FAMACHA
id <- unique(ID)[3]
value <- !is.na(variable)
validRecord <- ID %in% id & value
R <- 0.5
n <- max(order(YEAR[validRecord]))
vRn <- Rn(n = n,R = R)
year <- YEAR[validRecord]
nValues <- mean(variable[validRecord][seq_len(max(year)) %in% year])
ERPA <- nValues * vRn
ACC <- sqrt(vRn)
cbind(ID = id, n = n,ERPA, ACC)
id <- unique(ID)[6]
value <- !is.na(variable)
validRecord <- ID %in% id & value
R <- 0.5
n <- max(order(YEAR[validRecord]))
vRn <- Rn(n = n,R = R)
year <- YEAR[validRecord]
nValues <- mean(variable[validRecord][seq_len(max(year)) %in% year])
ERPA <- nValues * vRn
ACC <- sqrt(vRn)
cbind(ID = id, n = n,ERPA, ACC)
cbind(ID = id, AVG = nValues, n = n,ERPA, ACC)
variable <- a$FAMACHA
id <- unique(ID)[6]
value <- !is.na(variable)
validRecord <- ID %in% id & value
R <- 0.5
n <- max(order(YEAR[validRecord]))
vRn <- Rn(n = n,R = R)
year <- YEAR[validRecord]
nValues <- round(mean(variable[validRecord][seq_len(max(year)) %in% year]),2)
ERPA <- round(nValues * vRn,2)
ACC <- round(sqrt(vRn),2)
cbind(ID = id, AVG = nValues, n = n,ERPA, ACC)
variable <- adjust(values = FAMACHA, groups = YEAR)
variable <- a$FAMACHA
variable <- adjust(values = FAMACHA, groups = YEAR)
id <- unique(ID)[6]
value <- !is.na(variable)
validRecord <- ID %in% id & value
R <- 0.5
n <- max(order(YEAR[validRecord]))
vRn <- Rn(n = n,R = R)
year <- YEAR[validRecord]
nValues <- round(mean(variable[validRecord][seq_len(max(year)) %in% year]),2)
ERPA <- round(nValues * vRn,2)
ACC <- round(sqrt(vRn),2)
cbind(ID = id, AVG = nValues, n = n,ERPA, ACC)
computeERPA <- function(measurement, R){
variable <- adjust(values = measurement, groups = YEAR)
sapply(unique(ID), function(id){
value <- !is.na(variable)
validRecord <- ID %in% id & value
n <- max(order(YEAR[validRecord]))
vRn <- (n*R/(1+(n-1)*R))
year <- YEAR[validRecord]
nValues <- round(mean(variable[validRecord][seq_len(max(year)) %in% year]),2)
ERPA <- round(nValues * vRn,2)
ACC <- round(sqrt(vRn),2)
cbind(ID = id, AVERAGE = nValues, n = n,ERPA, ACC)
})
}
id <- 3
measurement <- FAMACHA
dorperSheep <- read.csv("../data/dorperSheep.csv")
attach(dorperSheep)
dorperSheep
R <- 0.09
value <- !is.na(variable)
variable <- adjust(values = measurement, groups = YEAR)
adjust <- function (values, groups) {
newValues <- values
for (group in unique(groups)) {
groupElements <- groups %in% group
groupCenter <- mean(values[groupElements], na.rm = TRUE)
newValues[groupElements] <- (values[groupElements] - groupCenter)
}
return(newValues)
}
value <- !is.na(variable)
variable <- adjust(values = measurement, groups = YEAR)
variable
variable <- adjust(values = measurement, groups = YEAR)
variable
dorperSheep <- read.csv("../data/dorperSheep.csv")
attach(dorperSheep)
dorperSheep <- read.csv("../data/dorperSheep.csv")
attach(dorperSheep)
dorperSheep
adjust <- function (values, groups) {
newValues <- values
for (group in unique(groups)) {
groupElements <- groups %in% group
groupCenter <- mean(values[groupElements], na.rm = TRUE)
newValues[groupElements] <- (values[groupElements] - groupCenter)
}
return(newValues)
}
measurement <- FAMACHA
R <- 0.09
variable <- adjust(values = measurement, groups = YEAR)
variable
t(sapply(unique(ID), function(id){
value <- !is.na(variable)
validRecord <- ID %in% id & value
n <- max(order(YEAR[validRecord]))
vRn <- (n*R/(1+(n-1)*R))
year <- YEAR[validRecord]
nValues <- round(mean(variable[validRecord][seq_len(max(year)) %in% year]),2)
ERPA <- round(nValues * vRn,2)
ACC <- round(sqrt(vRn),2)
cbind(ID = id, AVERAGE = nValues, n = n,ERPA, ACC)
}))
id <- 8
value <- !is.na(variable)
value
validRecord <- ID %in% id & value
validRecord
n <- max(order(YEAR[validRecord]))
n
vRn <- (n*R/(1+(n-1)*R))
vRn
year <- YEAR[validRecord]
year
variable[validRecord]
seq_len(max(year)) %in% year
nValues <- round(mean(variable[validRecord][year %in% seq_len(max(year))]),2)
nValues
ERPA <- round(nValues * vRn,2)
ACC <- round(sqrt(vRn),2)
cbind(ID = id, AVERAGE = nValues, n = n,ERPA, ACC)
a <- read.csv("../data/test.csv")
attach(a)
computeERPA <- function(measurement, R){
variable <- adjust(values = measurement, groups = YEAR)
t(sapply(unique(ID), function(id){
value <- !is.na(variable)
validRecord <- ID %in% id & value
n <- max(order(YEAR[validRecord]))
vRn <- (n*R/(1+(n-1)*R))
year <- YEAR[validRecord]
nValues <- round(mean(variable[validRecord][year %in% seq_len(max(year))]),2)
ERPA <- round(nValues * vRn,2)
ACC <- round(sqrt(vRn),2)
cbind(ID = id, AVERAGE = nValues, n = n,ERPA, ACC)
}))
}
computeERPA(measurement = FAMACHA, R = 0.09)
computeERPA(measurement = FAMACHA, R = 0.5)
a <- read.csv("../data/test.csv")
attach(a)
computeERPA <- function(measurement, R){
variable <- adjust(values = measurement, groups = YEAR)
t(sapply(unique(ID), function(id){
value <- !is.na(variable)
validRecord <- ID %in% id & value
n <- max(order(YEAR[validRecord]))
vRn <- (n*R/(1+(n-1)*R))
year <- YEAR[validRecord]
nValues <- round(mean(variable[validRecord][year %in% seq_len(max(year))]),2)
ERPA <- round(nValues * vRn,2)
ACC <- round(sqrt(vRn),2)
cbind(ID = id, AVERAGE = nValues, n = n,ERPA, ACC)
}))
}
computeERPA(measurement = FAMACHA, R = 0.5)
-5 + -25 + -10
mean(-5 + -25 + -10)
mean(c(-5,-25,-10))
measurement = FAMACHA
id <- 8
variable <- adjust(values = measurement, groups = YEAR)
variable
value <- !is.na(variable)
validRecord <- ID %in% id & value
n <- max(order(YEAR[validRecord]))
vRn <- (n*R/(1+(n-1)*R))
year <- YEAR[validRecord]
year
nValues <- round(mean(variable[validRecord][year %in% seq_len(max(year))]),2)
nValues
variable[validRecord]
value <- !is.na(variable)
value
ID %in% id
validRecord <- ID %in% id & value
variable[validRecord]
a <- read.csv("../data/test.csv")
variable <- adjust(values = measurement, groups = YEAR)
value <- !is.na(variable)
validRecord <- ID %in% id & value
n <- max(order(YEAR[validRecord]))
vRn <- (n*R/(1+(n-1)*R))
year <- YEAR[validRecord]
nValues <- round(mean(variable[validRecord][year %in% seq_len(max(year))]),2)
nValues
variable[validRecord]
is.na(values)
adjust <- function (values, groups) {
newValues <- values
for (group in unique(groups)) {
groupElements <- groups %in% group
groupCenter <- mean(values[groupElements & !is.na(values)], na.rm = TRUE)
newValues[groupElements] <- (values[groupElements] - groupCenter)
}
return(newValues)
}
variable <- adjust(values = measurement, groups = YEAR)
t(sapply(unique(ID), function(id){
value <- !is.na(variable)
validRecord <- ID %in% id & value
n <- max(order(YEAR[validRecord]))
vRn <- (n*R/(1+(n-1)*R))
year <- YEAR[validRecord]
nValues <- round(mean(variable[validRecord][year %in% seq_len(max(year))]),2)
ERPA <- round(nValues * vRn,2)
ACC <- round(sqrt(vRn),2)
cbind(ID = id, AVERAGE = nValues, n = n,ERPA, ACC)
}))
computeERPA(measurement = FAMACHA, R = 0.5)
values[groupElements & !is.na(values)]
adjust <- function (values, groups) {
newValues <- values
for (group in unique(groups)) {
groupElements <- groups %in% group
groupCenter <- values[groupElements & !is.na(values)]
groupCenter <- mean(groupCenter, na.rm = TRUE)
newValues[groupElements] <- (values[groupElements] - groupCenter)
}
return(newValues)
}
adjust(values = BW, groups = AGE)
adjust <- function (values, groups) {
newValues <- values
for (group in unique(groups)) {
groupElements <- groups %in% group
groupCenter <- values[groupElements]
groupCenter <- groupCenter[!is.na(groupCenter)]
groupCenter <- mean(groupCenter, na.rm = TRUE)
newValues[groupElements] <- (values[groupElements] - groupCenter)
}
return(newValues)
}
adjust(values = BW, groups = AGE)
dorperSheep <- read.csv("../data/dorperSheep.csv")
attach(dorperSheep)
dorperSheep
adjust <- function (values, groups) {
newValues <- values
for (group in unique(groups)) {
groupElements <- groups %in% group
groupCenter <- values[groupElements]
groupCenter <- groupCenter[!is.na(groupCenter)]
groupCenter <- mean(groupCenter, na.rm = TRUE)
newValues[groupElements] <- (values[groupElements] - groupCenter)
}
return(newValues)
}
adjust(values = BW, groups = AGE)
(4*0.09/(1+(4-1)*0.09))
sqrt((4*0.09/(1+(4-1)*0.09)))
mean(c(25,15,15))
a <- read.csv("../data/test.csv")
attach(a)
computeERPA <- function(measurement, R) {
variable <- adjust(values = measurement, groups = YEAR)
ERPA <- t(sapply(unique(ID), function(id) {
value <- !is.na(variable)
validRecord <- ID %in% id & value
n <- max(order(YEAR[validRecord]))
vRn <- (n * R / (1 + (n - 1) * R))
year <- YEAR[validRecord]
nValues <-
round(mean(variable[validRecord][year %in% seq_len(max(year))]), 2)
ERPA <- round(nValues * vRn, 2)
ACC <- round(sqrt(vRn), 2)
cbind(id,
nValues,
n,
ERPA,
ACC)
}))
colnames(ERPA) <- c("ID", "AVERAGE", "n", "ERPA", "ACC")
return(ERPA)
}
computeERPA(measurement = FAMACHA, R = 0.09)
computeERPA(measurement = FAMACHA, R = 0.5)
seq(0,1,0.01)
seq(0,1,0.01)*seq(0,1,0.01)
